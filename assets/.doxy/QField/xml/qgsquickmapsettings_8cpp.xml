<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="qgsquickmapsettings_8cpp" kind="file" language="C++">
    <compoundname>qgsquickmapsettings.cpp</compoundname>
    <includes refid="qgsquickmapsettings_8h" local="yes">qgsquickmapsettings.h</includes>
    <includes local="no">qgis.h</includes>
    <includes local="no">qgsmaplayer.h</includes>
    <includes local="no">qgsmaplayerstylemanager.h</includes>
    <includes local="no">qgsmessagelog.h</includes>
    <includes local="no">qgsproject.h</includes>
    <includes local="no">qgsprojectelevationproperties.h</includes>
    <includes local="no">qgsprojectviewsettings.h</includes>
    <incdepgraph>
      <node id="1">
        <label>src/core/qgsquick/qgsquickmapsettings.cpp</label>
        <link refid="qgsquickmapsettings_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>qgsquickmapsettings.h</label>
        <link refid="qgsquickmapsettings_8h_source"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>QObject</label>
      </node>
      <node id="3">
        <label>qfield_core_export.h</label>
      </node>
      <node id="11">
        <label>qgis.h</label>
      </node>
      <node id="5">
        <label>qgscoordinatetransformcontext.h</label>
      </node>
      <node id="6">
        <label>qgsmaplayer.h</label>
      </node>
      <node id="12">
        <label>qgsmaplayerstylemanager.h</label>
      </node>
      <node id="7">
        <label>qgsmapsettings.h</label>
      </node>
      <node id="8">
        <label>qgsmapthemecollection.h</label>
      </node>
      <node id="13">
        <label>qgsmessagelog.h</label>
      </node>
      <node id="9">
        <label>qgspoint.h</label>
      </node>
      <node id="14">
        <label>qgsproject.h</label>
      </node>
      <node id="15">
        <label>qgsprojectelevationproperties.h</label>
      </node>
      <node id="16">
        <label>qgsprojectviewsettings.h</label>
      </node>
      <node id="10">
        <label>qgsrectangle.h</label>
      </node>
    </incdepgraph>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/***************************************************************************</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/><sp/>qgsquickmapsettings.cpp</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/><sp/>--------------------------------------</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/><sp/>Date<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>27.12.2014</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/><sp/>Copyright<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>(C)<sp/>2014<sp/>by<sp/>Matthias<sp/>Kuhn</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/><sp/>Email<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>matthias<sp/>(at)<sp/>opengis.ch</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>***************************************************************************</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/><sp/><sp/>This<sp/>program<sp/>is<sp/>free<sp/>software;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify<sp/><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by<sp/><sp/>*</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/><sp/><sp/>the<sp/>Free<sp/>Software<sp/>Foundation;<sp/>either<sp/>version<sp/>2<sp/>of<sp/>the<sp/>License,<sp/>or<sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/><sp/><sp/>(at<sp/>your<sp/>option)<sp/>any<sp/>later<sp/>version.<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>***************************************************************************/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;qgsquickmapsettings.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;qgis.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;qgsmaplayer.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;qgsmaplayerstylemanager.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;qgsmessagelog.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;qgsproject.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;qgsprojectelevationproperties.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;qgsprojectviewsettings.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"><ref refid="classQgsQuickMapSettings_1a09b05b0e6e7fd69703b9ade407d38c20" kindref="member">QgsQuickMapSettings::QgsQuickMapSettings</ref>(<sp/>QObject<sp/>*parent<sp/>)</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/>:<sp/>QObject(<sp/>parent<sp/>)</highlight></codeline>
<codeline lineno="29"><highlight class="normal">{</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Connect<sp/>signals<sp/>for<sp/>derived<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/>connect(<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a5bbaee0bf1722dc39bd5b3c62e2ba7d9" kindref="member">QgsQuickMapSettings::destinationCrsChanged</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a17f499848a3b70f57c9a7b19361e911d" kindref="member">QgsQuickMapSettings::mapUnitsPerPointChanged</ref><sp/>);</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/>connect(<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a1956e57291066171d306c1981691f5be" kindref="member">QgsQuickMapSettings::extentChanged</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a17f499848a3b70f57c9a7b19361e911d" kindref="member">QgsQuickMapSettings::mapUnitsPerPointChanged</ref><sp/>);</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/>connect(<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a2024918fa14e5d9859b894ed33786bdf" kindref="member">QgsQuickMapSettings::outputSizeChanged</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a17f499848a3b70f57c9a7b19361e911d" kindref="member">QgsQuickMapSettings::mapUnitsPerPointChanged</ref><sp/>);</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/>connect(<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a1956e57291066171d306c1981691f5be" kindref="member">QgsQuickMapSettings::extentChanged</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a629128b24007f86bc9a978a6a58f63c0" kindref="member">QgsQuickMapSettings::visibleExtentChanged</ref><sp/>);</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/>connect(<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1adbaa9fe6328d1267c71dc5887808ec65" kindref="member">QgsQuickMapSettings::rotationChanged</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a629128b24007f86bc9a978a6a58f63c0" kindref="member">QgsQuickMapSettings::visibleExtentChanged</ref><sp/>);</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/>connect(<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a2024918fa14e5d9859b894ed33786bdf" kindref="member">QgsQuickMapSettings::outputSizeChanged</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;<ref refid="classQgsQuickMapSettings_1a629128b24007f86bc9a978a6a58f63c0" kindref="member">QgsQuickMapSettings::visibleExtentChanged</ref><sp/>);</highlight></codeline>
<codeline lineno="37"><highlight class="normal">}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1aa39988b49f56e2f3aa89c755d3c0c9b0" kindref="member">QgsQuickMapSettings::setProject</ref>(<sp/>QgsProject<sp/>*project<sp/>)</highlight></codeline>
<codeline lineno="40"><highlight class="normal">{</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="classQgsQuickMapSettings_1af9342d711e05f92f1a20ae42ee114acb" kindref="member">project</ref><sp/>==<sp/>mProject<sp/>)</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>If<sp/>we<sp/>have<sp/>already<sp/>something<sp/>connected,<sp/>disconnect<sp/>it!</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mProject<sp/>)</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>mProject-&gt;disconnect(<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/>mProject<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1af9342d711e05f92f1a20ae42ee114acb" kindref="member">project</ref>;</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>Connect<sp/>all<sp/>signals</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mProject<sp/>)</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/>connect(<sp/>mProject,<sp/>&amp;QgsProject::readProject,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;QgsQuickMapSettings::onReadProject<sp/>);</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>connect(<sp/>mProject,<sp/>&amp;QgsProject::crsChanged,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>&amp;QgsQuickMapSettings::onCrsChanged<sp/>);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1ac42107f6cc35b3de8b2369bbff72654b" kindref="member">setDestinationCrs</ref>(<sp/>mProject-&gt;crs()<sp/>);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>mMapSettings.setTransformContext(<sp/>mProject-&gt;transformContext()<sp/>);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>mMapSettings.setPathResolver(<sp/>mProject-&gt;pathResolver()<sp/>);</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>mMapSettings.setTransformContext(<sp/>QgsCoordinateTransformContext()<sp/>);</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a3944b588e676c13880af329fe10ed686" kindref="member">projectChanged</ref>();</highlight></codeline>
<codeline lineno="68"><highlight class="normal">}</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal">QgsProject<sp/>*<ref refid="classQgsQuickMapSettings_1af9342d711e05f92f1a20ae42ee114acb" kindref="member">QgsQuickMapSettings::project</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="71"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mProject;</highlight></codeline>
<codeline lineno="73"><highlight class="normal">}</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal">QgsCoordinateTransformContext<sp/><ref refid="classQgsQuickMapSettings_1a3c930bca60efefc0a85571312d479a23" kindref="member">QgsQuickMapSettings::transformContext</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="76"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.transformContext();</highlight></codeline>
<codeline lineno="78"><highlight class="normal">}</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal">QgsRectangle<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">QgsQuickMapSettings::extent</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="81"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.extent();</highlight></codeline>
<codeline lineno="83"><highlight class="normal">}</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ab594ae8219e176a00187974fcd358693" kindref="member">QgsQuickMapSettings::setExtent</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsRectangle<sp/>&amp;extent,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>handleMargins<sp/>)</highlight></codeline>
<codeline lineno="86"><highlight class="normal">{</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>applyExtent(<sp/>mMapSettings,<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>,<sp/>handleMargins<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a1956e57291066171d306c1981691f5be" kindref="member">extentChanged</ref>();</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="91"><highlight class="normal">}</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a29f3ea6bb84e66600998219a78c70c70" kindref="member">QgsQuickMapSettings::computeScaleForExtent</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsRectangle<sp/>&amp;extent,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>handleMargins<sp/>)</highlight></codeline>
<codeline lineno="94"><highlight class="normal">{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/>QgsMapSettings<sp/>settings(<sp/>mMapSettings<sp/>);</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/>applyExtent(<sp/>settings,<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>,<sp/>handleMargins<sp/>);</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>settings.scale();</highlight></codeline>
<codeline lineno="98"><highlight class="normal">}</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>QgsQuickMapSettings::applyExtent(<sp/>QgsMapSettings<sp/>&amp;mapSettings,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsRectangle<sp/>&amp;extent,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>handleMargins<sp/>)</highlight></codeline>
<codeline lineno="101"><highlight class="normal">{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>handleMargins<sp/>&amp;&amp;<sp/>(<sp/>!qgsDoubleNear(<sp/>mRightMargin,<sp/>0.0<sp/>)<sp/>||<sp/>!qgsDoubleNear(<sp/>mBottomMargin,<sp/>0.0<sp/>)<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ae1ba0e3f2a070ee404bd36e563cac4b1" kindref="member">rightMargin</ref><sp/>=<sp/>mRightMargin<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>();</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a6a959fc142ddec4ec31981192257fbcd" kindref="member">bottomMargin</ref><sp/>=<sp/>mBottomMargin<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>();</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>outputSizeRatio<sp/>=<sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">double</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>().width()<sp/>)<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>().height();</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>extentRatio<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.width()<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.height();</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>an<sp/>extent<sp/>that<sp/>matches<sp/>the<sp/>output<sp/>size<sp/>translated<sp/>by<sp/>current<sp/>margin<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>QgsRectangle<sp/>outputSizeExtent;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>extentRatio<sp/>&gt;<sp/>outputSizeRatio<sp/>)</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>widthAdjustement<sp/>=<sp/>(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.width()<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>().width()<sp/>)<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1ae1ba0e3f2a070ee404bd36e563cac4b1" kindref="member">rightMargin</ref>;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>height<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.width()<sp/>/<sp/>outputSizeRatio;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>heightAdjustment<sp/>=<sp/>(<sp/>height<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>().height()<sp/>)<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1a6a959fc142ddec4ec31981192257fbcd" kindref="member">bottomMargin</ref>;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>heightMiddle<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.yMinimum()<sp/>+<sp/>(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.height()<sp/>/<sp/>2<sp/>);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputSizeExtent.setXMinimum(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.xMinimum()<sp/>+<sp/>widthAdjustement<sp/>);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputSizeExtent.setXMaximum(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.xMaximum()<sp/>+<sp/>widthAdjustement<sp/>);</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputSizeExtent.setYMinimum(<sp/>heightMiddle<sp/>-<sp/>(<sp/>height<sp/>/<sp/>2<sp/>)<sp/>-<sp/>heightAdjustment<sp/>);</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputSizeExtent.setYMaximum(<sp/>heightMiddle<sp/>+<sp/>(<sp/>height<sp/>/<sp/>2<sp/>)<sp/>-<sp/>heightAdjustment<sp/>);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>heightAdjustment<sp/>=<sp/>(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.height()<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>().height()<sp/>)<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1a6a959fc142ddec4ec31981192257fbcd" kindref="member">bottomMargin</ref>;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>width<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.height()<sp/>*<sp/>outputSizeRatio;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>widthAdjustement<sp/>=<sp/>(<sp/>width<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>().width()<sp/>)<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1ae1ba0e3f2a070ee404bd36e563cac4b1" kindref="member">rightMargin</ref>;</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>widthMiddle<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.xMinimum()<sp/>+<sp/>(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.width()<sp/>/<sp/>2<sp/>);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputSizeExtent.setXMinimum(<sp/>widthMiddle<sp/>-<sp/>(<sp/>width<sp/>/<sp/>2<sp/>)<sp/>+<sp/>widthAdjustement<sp/>);</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputSizeExtent.setXMaximum(<sp/>widthMiddle<sp/>+<sp/>(<sp/>width<sp/>/<sp/>2<sp/>)<sp/>+<sp/>widthAdjustement<sp/>);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputSizeExtent.setYMinimum(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.yMinimum()<sp/>-<sp/>heightAdjustment<sp/>);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>outputSizeExtent.setYMaximum(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.yMaximum()<sp/>-<sp/>heightAdjustment<sp/>);</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Combine<sp/>the<sp/>extent<sp/>with<sp/>the<sp/>translated<sp/>output<sp/>size<sp/>extent</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/>QgsRectangle<sp/>modifiedExtent<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>modifiedExtent.combineExtentWith(<sp/>outputSizeExtent<sp/>);</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>modifiedExtent.isNull()<sp/>)</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Set<sp/>the<sp/>extent<sp/>to<sp/>get<sp/>an<sp/>updated<sp/>map<sp/>units<sp/>per<sp/>pixel<sp/>value</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsRectangle<sp/>originalExtent<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.extent();</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.setExtent(<sp/>modifiedExtent<sp/>);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/>modifiedExtent<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.extent();</highlight></codeline>
<codeline lineno="146"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsVector<sp/>delta<sp/>=<sp/>QgsPointXY(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.center()<sp/>)<sp/>-<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.extent().center();</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>base<sp/>margin<sp/>adjustments<sp/>(split<sp/>in<sp/>half<sp/>for<sp/>centering)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>baseXAdjustment<sp/>=<sp/>-<ref refid="classQgsQuickMapSettings_1ae1ba0e3f2a070ee404bd36e563cac4b1" kindref="member">rightMargin</ref><sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.mapUnitsPerPixel()<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>baseYAdjustment<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a6a959fc142ddec4ec31981192257fbcd" kindref="member">bottomMargin</ref><sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.mapUnitsPerPixel()<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="152"><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Adjust<sp/>margins<sp/>based<sp/>on<sp/>rotation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rotationRadians<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.rotation()<sp/>*<sp/>M_PI<sp/>/<sp/>180.0;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>xAdjustment<sp/>=<sp/>baseXAdjustment<sp/>*<sp/>cos(<sp/>rotationRadians<sp/>)<sp/>-<sp/>baseYAdjustment<sp/>*<sp/>sin(<sp/>rotationRadians<sp/>);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>yAdjustment<sp/>=<sp/>baseXAdjustment<sp/>*<sp/>sin(<sp/>rotationRadians<sp/>)<sp/>+<sp/>baseYAdjustment<sp/>*<sp/>cos(<sp/>rotationRadians<sp/>);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>modifiedExtent.setXMinimum(<sp/>modifiedExtent.xMinimum()<sp/>+<sp/>delta.x()<sp/>-<sp/>xAdjustment<sp/>);</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/>modifiedExtent.setXMaximum(<sp/>modifiedExtent.xMaximum()<sp/>+<sp/>delta.x()<sp/>-<sp/>xAdjustment<sp/>);</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>modifiedExtent.setYMinimum(<sp/>modifiedExtent.yMinimum()<sp/>+<sp/>delta.y()<sp/>-<sp/>yAdjustment<sp/>);</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>modifiedExtent.setYMaximum(<sp/>modifiedExtent.yMaximum()<sp/>+<sp/>delta.y()<sp/>-<sp/>yAdjustment<sp/>);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>originalExtent<sp/>==<sp/>modifiedExtent<sp/>||<sp/>modifiedExtent.isNull()<sp/>)</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.setExtent(<sp/>modifiedExtent<sp/>);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.extent()<sp/>==<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref><sp/>||<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.isNull()<sp/>)</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>.setExtent(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref><sp/>);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="177"><highlight class="normal">}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal">QgsPoint<sp/><ref refid="classQgsQuickMapSettings_1a03b4375ce2ad4a67021691c0766f4963" kindref="member">QgsQuickMapSettings::getCenter</ref>(<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>handleMargins<sp/>)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="180"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>handleMargins<sp/>&amp;&amp;<sp/>(<sp/>!qgsDoubleNear(<sp/>mRightMargin,<sp/>0.0<sp/>)<sp/>||<sp/>!qgsDoubleNear(<sp/>mBottomMargin,<sp/>0.0<sp/>)<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Get<sp/>current<sp/>extent</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/>QgsRectangle<sp/>e<sp/>=<sp/>mMapSettings.extent();</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>base<sp/>margin<sp/>adjustments<sp/>(split<sp/>in<sp/>half<sp/>for<sp/>centering)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>baseXAdjustment<sp/>=<sp/>-mRightMargin<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>*<sp/>mMapSettings.mapUnitsPerPixel()<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>baseYAdjustment<sp/>=<sp/>mBottomMargin<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>*<sp/>mMapSettings.mapUnitsPerPixel()<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Adjust<sp/>margins<sp/>based<sp/>on<sp/>rotation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rotationRadians<sp/>=<sp/>mMapSettings.rotation()<sp/>*<sp/>M_PI<sp/>/<sp/>180.0;</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>xAdjustment<sp/>=<sp/>baseXAdjustment<sp/>*<sp/>cos(<sp/>rotationRadians<sp/>)<sp/>-<sp/>baseYAdjustment<sp/>*<sp/>sin(<sp/>rotationRadians<sp/>);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>yAdjustment<sp/>=<sp/>baseXAdjustment<sp/>*<sp/>sin(<sp/>rotationRadians<sp/>)<sp/>+<sp/>baseYAdjustment<sp/>*<sp/>cos(<sp/>rotationRadians<sp/>);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>the<sp/>adjusted<sp/>center</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/>QgsPointXY<sp/>adjustedCenter<sp/>=<sp/>e.center();</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/>adjustedCenter.setX(<sp/>adjustedCenter.x()<sp/>+<sp/>xAdjustment<sp/>);</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/>adjustedCenter.setY(<sp/>adjustedCenter.y()<sp/>+<sp/>yAdjustment<sp/>);</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>QgsPoint(<sp/>adjustedCenter<sp/>);</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>QgsPoint(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>().<ref refid="classQgsQuickMapSettings_1aeba1702a5790dcf64a71dec06f941e45" kindref="member">center</ref>()<sp/>);</highlight></codeline>
<codeline lineno="204"><highlight class="normal">}</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ace8e843b313546ed7d2e110551a74a61" kindref="member">QgsQuickMapSettings::setCenter</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsPoint<sp/>&amp;center,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>handleMargins<sp/>)</highlight></codeline>
<codeline lineno="207"><highlight class="normal">{</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="classQgsQuickMapSettings_1aeba1702a5790dcf64a71dec06f941e45" kindref="member">center</ref>.isEmpty()<sp/>)</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsVector<sp/>delta<sp/>=<sp/>QgsPointXY(<sp/><ref refid="classQgsQuickMapSettings_1aeba1702a5790dcf64a71dec06f941e45" kindref="member">center</ref><sp/>)<sp/>-<sp/>mMapSettings.extent().center();</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/>QgsRectangle<sp/>e<sp/>=<sp/>mMapSettings.extent();</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>handleMargins<sp/>&amp;&amp;<sp/>(<sp/>!qgsDoubleNear(<sp/>mRightMargin,<sp/>0.0<sp/>)<sp/>||<sp/>!qgsDoubleNear(<sp/>mBottomMargin,<sp/>0.0<sp/>)<sp/>)<sp/>)</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Calculate<sp/>base<sp/>margin<sp/>adjustments<sp/>(split<sp/>in<sp/>half<sp/>for<sp/>centering)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>baseXAdjustment<sp/>=<sp/>-mRightMargin<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>*<sp/>mMapSettings.mapUnitsPerPixel()<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>baseYAdjustment<sp/>=<sp/>mBottomMargin<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>*<sp/>mMapSettings.mapUnitsPerPixel()<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Adjust<sp/>margins<sp/>based<sp/>on<sp/>rotation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rotationRadians<sp/>=<sp/>mMapSettings.rotation()<sp/>*<sp/>M_PI<sp/>/<sp/>180.0;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>xAdjustment<sp/>=<sp/>baseXAdjustment<sp/>*<sp/>cos(<sp/>rotationRadians<sp/>)<sp/>-<sp/>baseYAdjustment<sp/>*<sp/>sin(<sp/>rotationRadians<sp/>);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>yAdjustment<sp/>=<sp/>baseXAdjustment<sp/>*<sp/>sin(<sp/>rotationRadians<sp/>)<sp/>+<sp/>baseYAdjustment<sp/>*<sp/>cos(<sp/>rotationRadians<sp/>);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/>e.setXMinimum(<sp/>e.xMinimum()<sp/>+<sp/>delta.x()<sp/>-<sp/>xAdjustment<sp/>);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>e.setXMaximum(<sp/>e.xMaximum()<sp/>+<sp/>delta.x()<sp/>-<sp/>xAdjustment<sp/>);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/>e.setYMinimum(<sp/>e.yMinimum()<sp/>+<sp/>delta.y()<sp/>-<sp/>yAdjustment<sp/>);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>e.setYMaximum(<sp/>e.yMaximum()<sp/>+<sp/>delta.y()<sp/>-<sp/>yAdjustment<sp/>);</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/>e.setXMinimum(<sp/>e.xMinimum()<sp/>+<sp/>delta.x()<sp/>);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>e.setXMaximum(<sp/>e.xMaximum()<sp/>+<sp/>delta.x()<sp/>);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>e.setYMinimum(<sp/>e.yMinimum()<sp/>+<sp/>delta.y()<sp/>);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>e.setYMaximum(<sp/>e.yMaximum()<sp/>+<sp/>delta.y()<sp/>);</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="236"><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><ref refid="classQgsQuickMapSettings_1ab594ae8219e176a00187974fcd358693" kindref="member">setExtent</ref>(<sp/>e<sp/>);</highlight></codeline>
<codeline lineno="238"><highlight class="normal">}</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ace8e843b313546ed7d2e110551a74a61" kindref="member">QgsQuickMapSettings::setCenter</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QPointF<sp/>&amp;center,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>handleMargins<sp/>)</highlight></codeline>
<codeline lineno="241"><highlight class="normal">{</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ace8e843b313546ed7d2e110551a74a61" kindref="member">setCenter</ref>(<sp/>QgsPoint(<sp/><ref refid="classQgsQuickMapSettings_1aeba1702a5790dcf64a71dec06f941e45" kindref="member">center</ref><sp/>),<sp/>handleMargins<sp/>);</highlight></codeline>
<codeline lineno="243"><highlight class="normal">}</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ab90f2fc5eea9c6ae1dac85e5d1b970ab" kindref="member">QgsQuickMapSettings::setCenterToLayer</ref>(<sp/>QgsMapLayer<sp/>*layer,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>shouldZoom<sp/>)</highlight></codeline>
<codeline lineno="246"><highlight class="normal">{</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/>Q_ASSERT(<sp/>layer<sp/>);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsRectangle<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref><sp/>=<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">mapSettings</ref>().layerToMapCoordinates(<sp/>layer,<sp/>layer-&gt;extent()<sp/>);</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!<ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.isEmpty()<sp/>)</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>shouldZoom<sp/>)</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1ab594ae8219e176a00187974fcd358693" kindref="member">setExtent</ref>(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref><sp/>);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1ace8e843b313546ed7d2e110551a74a61" kindref="member">setCenter</ref>(<sp/>QgsPoint(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.center()<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="258"><highlight class="normal">}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a6bdc52ea81468cc915061c0376870b7f" kindref="member">QgsQuickMapSettings::setExtentFromPoints</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QVariantList<sp/>&amp;points,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>&amp;minimumScale,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>handleMargins<sp/>)</highlight></codeline>
<codeline lineno="261"><highlight class="normal">{</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>points.isEmpty()<sp/>)</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>points.size()<sp/>==<sp/>1<sp/>)</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/>QgsPoint<sp/>p<sp/>=<sp/>points.at(<sp/>0<sp/>).value&lt;QgsPoint&gt;();</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!p.isEmpty()<sp/>)</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1ace8e843b313546ed7d2e110551a74a61" kindref="member">setCenter</ref>(<sp/>p,<sp/>handleMargins<sp/>);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/>QgsRectangle<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>;</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>&amp;<ref refid="classpoint" kindref="compound">point</ref><sp/>:<sp/>points<sp/>)</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>QgsPoint<sp/>p<sp/>=<sp/><ref refid="classpoint" kindref="compound">point</ref>.value&lt;QgsPoint&gt;();</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>p.isEmpty()<sp/>)</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.combineExtentWith(<sp/>p.x(),<sp/>p.y()<sp/>);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/>QSize<sp/>size<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>();</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/>size<sp/>/=<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>();</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>unitPerPoint<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>buffer<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.width()<sp/>&gt;<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.height()<sp/>)</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>unitPerPoint<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.width()<sp/>/<sp/>size.width();</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>unitPerPoint<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.height()<sp/>/<sp/>size.height();</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/>buffer<sp/>=<sp/>80<sp/>*<sp/>unitPerPoint;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>minimumScale<sp/>&gt;<sp/>0.0<sp/>)</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>QgsScaleCalculator<sp/>calc;</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/>calc.setMapUnits(<sp/>mMapSettings.destinationCrs().mapUnits()<sp/>);</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/>calc.setDpi(<sp/><ref refid="classQgsQuickMapSettings_1a08181add28740e8762bee7ee5a93307f" kindref="member">outputDpi</ref>()<sp/>);</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ad379f5b63eefd0cc2f6f2424735719e0" kindref="member">scale</ref><sp/>=<sp/>calc.calculate(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>,<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>().width()<sp/>);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/><ref refid="classQgsQuickMapSettings_1ad379f5b63eefd0cc2f6f2424735719e0" kindref="member">scale</ref><sp/>&lt;<sp/>minimumScale<sp/>)</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.scale(<sp/>minimumScale<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1ad379f5b63eefd0cc2f6f2424735719e0" kindref="member">scale</ref><sp/>);</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><ref refid="classQgsQuickMapSettings_1ab594ae8219e176a00187974fcd358693" kindref="member">setExtent</ref>(<sp/><ref refid="classQgsQuickMapSettings_1a1fae7b1cc02972fbdb36c05b331d1cb8" kindref="member">extent</ref>.buffered(<sp/>buffer<sp/>),<sp/>handleMargins<sp/>);</highlight></codeline>
<codeline lineno="309"><highlight class="normal">}</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1aa04c21ca7d0aab10e65d1bc6b0f4313d" kindref="member">QgsQuickMapSettings::mapUnitsPerPoint</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="312"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.mapUnitsPerPixel()<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>();</highlight></codeline>
<codeline lineno="314"><highlight class="normal">}</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal">QgsRectangle<sp/><ref refid="classQgsQuickMapSettings_1a4c918426a29c03035ba8aa670549dbcb" kindref="member">QgsQuickMapSettings::visibleExtent</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="317"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.visibleExtent();</highlight></codeline>
<codeline lineno="319"><highlight class="normal">}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ad379f5b63eefd0cc2f6f2424735719e0" kindref="member">QgsQuickMapSettings::scale</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="322"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.scale();</highlight></codeline>
<codeline lineno="324"><highlight class="normal">}</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal">QPointF<sp/><ref refid="classQgsQuickMapSettings_1ae19d826e77f38d040bfa9410fb0c7d2e" kindref="member">QgsQuickMapSettings::coordinateToScreen</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsPoint<sp/>&amp;<ref refid="classpoint" kindref="compound">point</ref><sp/>)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="327"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/>QgsPointXY<sp/>pt(<sp/><ref refid="classpoint" kindref="compound">point</ref>.x(),<sp/><ref refid="classpoint" kindref="compound">point</ref>.y()<sp/>);</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/>QgsPointXY<sp/>pp<sp/>=<sp/>mMapSettings.mapToPixel().transform(<sp/>pt<sp/>);</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/>pp.setX(<sp/>pp.x()<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/>pp.setY(<sp/>pp.y()<sp/>/<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pp.toQPointF();</highlight></codeline>
<codeline lineno="333"><highlight class="normal">}</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal">QgsPoint<sp/><ref refid="classQgsQuickMapSettings_1a70b53cdb13b98778d4694631e9b754f7" kindref="member">QgsQuickMapSettings::screenToCoordinate</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QPointF<sp/>&amp;<ref refid="classpoint" kindref="compound">point</ref><sp/>)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="336"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsPointXY<sp/>pp<sp/>=<sp/>mMapSettings.mapToPixel().toMapCoordinates(<sp/><ref refid="classpoint" kindref="compound">point</ref>.x()<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>(),<sp/><ref refid="classpoint" kindref="compound">point</ref>.y()<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>);</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>QgsPoint(<sp/>pp<sp/>);</highlight></codeline>
<codeline lineno="339"><highlight class="normal">}</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal">QgsMapSettings<sp/><ref refid="classQgsQuickMapSettings_1aa0819eabfca106939c96d57f4d48d6f0" kindref="member">QgsQuickMapSettings::mapSettings</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="342"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings;</highlight></codeline>
<codeline lineno="344"><highlight class="normal">}</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal">QSize<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">QgsQuickMapSettings::outputSize</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="347"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.outputSize();</highlight></codeline>
<codeline lineno="349"><highlight class="normal">}</highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a0a981a8b02de04231dd4714c8e30518f" kindref="member">QgsQuickMapSettings::setOutputSize</ref>(<sp/>QSize<sp/>outputSize<sp/>)</highlight></codeline>
<codeline lineno="352"><highlight class="normal">{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>.setWidth(<sp/>std::ceil(<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>.width()<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>.setHeight(<sp/>std::ceil(<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref>.height()<sp/>*<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>()<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mMapSettings.outputSize()<sp/>==<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref><sp/>)</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="357"><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/>mMapSettings.setOutputSize(<sp/><ref refid="classQgsQuickMapSettings_1ad37b44f94ac4b34469468c5586f76ada" kindref="member">outputSize</ref><sp/>);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a2024918fa14e5d9859b894ed33786bdf" kindref="member">outputSizeChanged</ref>();</highlight></codeline>
<codeline lineno="360"><highlight class="normal">}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a08181add28740e8762bee7ee5a93307f" kindref="member">QgsQuickMapSettings::outputDpi</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="363"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.outputDpi();</highlight></codeline>
<codeline lineno="365"><highlight class="normal">}</highlight></codeline>
<codeline lineno="366"><highlight class="normal"></highlight></codeline>
<codeline lineno="367"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1aa5253290222c4c3f4c5f8cf45a27efd1" kindref="member">QgsQuickMapSettings::setOutputDpi</ref>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>outputDpi<sp/>)</highlight></codeline>
<codeline lineno="368"><highlight class="normal">{</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><ref refid="classQgsQuickMapSettings_1a08181add28740e8762bee7ee5a93307f" kindref="member">outputDpi</ref><sp/>*=<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>();</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>qgsDoubleNear(<sp/>mMapSettings.outputDpi(),<sp/><ref refid="classQgsQuickMapSettings_1a08181add28740e8762bee7ee5a93307f" kindref="member">outputDpi</ref><sp/>)<sp/>)</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/>mMapSettings.setOutputDpi(<sp/><ref refid="classQgsQuickMapSettings_1a08181add28740e8762bee7ee5a93307f" kindref="member">outputDpi</ref><sp/>);</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a534acbc9d4a6e9ef73708233f97efc92" kindref="member">outputDpiChanged</ref>();</highlight></codeline>
<codeline lineno="375"><highlight class="normal">}</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal">QgsCoordinateReferenceSystem<sp/><ref refid="classQgsQuickMapSettings_1abc3e11f665b5972a8f84b25270ddd49a" kindref="member">QgsQuickMapSettings::destinationCrs</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="378"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.destinationCrs();</highlight></codeline>
<codeline lineno="380"><highlight class="normal">}</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ac42107f6cc35b3de8b2369bbff72654b" kindref="member">QgsQuickMapSettings::setDestinationCrs</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsCoordinateReferenceSystem<sp/>&amp;destinationCrs<sp/>)</highlight></codeline>
<codeline lineno="383"><highlight class="normal">{</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mMapSettings.destinationCrs()<sp/>==<sp/><ref refid="classQgsQuickMapSettings_1abc3e11f665b5972a8f84b25270ddd49a" kindref="member">destinationCrs</ref><sp/>)</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/>mMapSettings.setDestinationCrs(<sp/><ref refid="classQgsQuickMapSettings_1abc3e11f665b5972a8f84b25270ddd49a" kindref="member">destinationCrs</ref><sp/>);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a5bbaee0bf1722dc39bd5b3c62e2ba7d9" kindref="member">destinationCrsChanged</ref>();</highlight></codeline>
<codeline lineno="389"><highlight class="normal">}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal">QList&lt;QgsMapLayer<sp/>*&gt;<sp/><ref refid="classQgsQuickMapSettings_1abf1d5b544debb49d3f886b75b5f18294" kindref="member">QgsQuickMapSettings::layers</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="392"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.layers();</highlight></codeline>
<codeline lineno="394"><highlight class="normal">}</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ab1007f4cff0f98a0dec50fad8db05b04" kindref="member">QgsQuickMapSettings::setLayers</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QList&lt;QgsMapLayer<sp/>*&gt;<sp/>&amp;layers<sp/>)</highlight></codeline>
<codeline lineno="397"><highlight class="normal">{</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/>mMapSettings.setLayers(<sp/><ref refid="classQgsQuickMapSettings_1abf1d5b544debb49d3f886b75b5f18294" kindref="member">layers</ref><sp/>);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a551323cbaf98c6c1da70cc35721a45df" kindref="member">layersChanged</ref>();</highlight></codeline>
<codeline lineno="400"><highlight class="normal">}</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>MapSettings::setMapTheme(<sp/>QgsProject<sp/>*project,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QString<sp/>&amp;mapThemeName<sp/>)</highlight></codeline>
<codeline lineno="404"><highlight class="normal">{</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/>QStringList<sp/>layerIds;</highlight></codeline>
<codeline lineno="406"><highlight class="normal"></highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/>QgsMapThemeCollection::MapThemeRecord<sp/>mapTheme<sp/>=<sp/>project-&gt;mapThemeCollection()-&gt;mapThemeState(<sp/>mapThemeName<sp/>);</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QList&lt;QgsMapThemeCollection::MapThemeLayerRecord&gt;<sp/>layerRecords<sp/>{<sp/>mapTheme.layerRecords()<sp/>};</highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsMapThemeCollection::MapThemeLayerRecord<sp/>&amp;record<sp/>:<sp/>layerRecords<sp/>)</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/>record.layer()-&gt;styleManager()-&gt;setCurrentStyle(<sp/>mapTheme.perLayerCurrentStyle().value(<sp/>layerId<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="414"><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/>layerIds<sp/>&lt;&lt;<sp/>layerId;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/>mMapSettings.setLayers(<sp/>layerIds<sp/>);</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/>emit<sp/>layersChanged();</highlight></codeline>
<codeline lineno="420"><highlight class="normal">}</highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>QgsQuickMapSettings::onCrsChanged()</highlight></codeline>
<codeline lineno="424"><highlight class="normal">{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><ref refid="classQgsQuickMapSettings_1ac42107f6cc35b3de8b2369bbff72654b" kindref="member">setDestinationCrs</ref>(<sp/>mProject-&gt;crs()<sp/>);</highlight></codeline>
<codeline lineno="426"><highlight class="normal">}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>QgsQuickMapSettings::onReadProject(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QDomDocument<sp/>&amp;doc<sp/>)</highlight></codeline>
<codeline lineno="429"><highlight class="normal">{</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mProject<sp/>)</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>red<sp/>=<sp/>mProject-&gt;readNumEntry(<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;Gui&quot;</highlight><highlight class="normal"><sp/>),<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;/CanvasColorRedPart&quot;</highlight><highlight class="normal"><sp/>),<sp/>255<sp/>);</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>green<sp/>=<sp/>mProject-&gt;readNumEntry(<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;Gui&quot;</highlight><highlight class="normal"><sp/>),<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;/CanvasColorGreenPart&quot;</highlight><highlight class="normal"><sp/>),<sp/>255<sp/>);</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>blue<sp/>=<sp/>mProject-&gt;readNumEntry(<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;Gui&quot;</highlight><highlight class="normal"><sp/>),<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;/CanvasColorBluePart&quot;</highlight><highlight class="normal"><sp/>),<sp/>255<sp/>);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/>mMapSettings.setBackgroundColor(<sp/>QColor(<sp/>red,<sp/>green,<sp/>blue<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a4b103fcf5ffc8a440aee6950a7ca4d90" kindref="member">isTemporal</ref><sp/>=<sp/>mProject-&gt;readNumEntry(<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;TemporalControllerWidget&quot;</highlight><highlight class="normal"><sp/>),<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;/NavigationMode&quot;</highlight><highlight class="normal"><sp/>),<sp/>0<sp/>)<sp/>!=<sp/>0;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QString<sp/>startString<sp/>=<sp/>QgsProject::instance()-&gt;readEntry(<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;TemporalControllerWidget&quot;</highlight><highlight class="normal"><sp/>),<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;/StartDateTime&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QString<sp/>endString<sp/>=<sp/>QgsProject::instance()-&gt;readEntry(<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;TemporalControllerWidget&quot;</highlight><highlight class="normal"><sp/>),<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;/EndDateTime&quot;</highlight><highlight class="normal"><sp/>)<sp/>);</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/>mMapSettings.setTemporalRange(<sp/>QgsDateTimeRange(<sp/>QDateTime::fromString(<sp/>startString,<sp/>Qt::ISODateWithMs<sp/>),</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>QDateTime::fromString(<sp/>endString,<sp/>Qt::ISODateWithMs<sp/>)<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/>mMapSettings.setIsTemporal(<sp/><ref refid="classQgsQuickMapSettings_1a4b103fcf5ffc8a440aee6950a7ca4d90" kindref="member">isTemporal</ref><sp/>);</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="444"><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/>QDomNodeList<sp/>nodes<sp/>=<sp/>doc.elementsByTagName(<sp/></highlight><highlight class="stringliteral">&quot;mapcanvas&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>foundTheMapCanvas<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>nodes.size();<sp/>i++<sp/>)</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>QDomNode<sp/>node<sp/>=<sp/>nodes.item(<sp/>i<sp/>);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/>QDomElement<sp/>element<sp/>=<sp/>node.toElement();</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>element.hasAttribute(<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;name&quot;</highlight><highlight class="normal"><sp/>)<sp/>)<sp/>&amp;&amp;<sp/>element.attribute(<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;name&quot;</highlight><highlight class="normal"><sp/>)<sp/>)<sp/>==<sp/>QStringLiteral(<sp/></highlight><highlight class="stringliteral">&quot;theMapCanvas&quot;</highlight><highlight class="normal"><sp/>)<sp/>)</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>foundTheMapCanvas<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>mMapSettings.readXml(<sp/>node<sp/>);</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>!foundTheMapCanvas<sp/>)</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>mMapSettings.setDestinationCrs(<sp/>mProject-&gt;crs()<sp/>);</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/>mMapSettings.setExtent(<sp/>mProject-&gt;viewSettings()-&gt;fullExtent()<sp/>);</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="463"><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/>mMapSettings.setTransformContext(<sp/>mProject-&gt;transformContext()<sp/>);</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/>mMapSettings.setPathResolver(<sp/>mProject-&gt;pathResolver()<sp/>);</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/>mMapSettings.setElevationShadingRenderer(<sp/>mProject-&gt;elevationShadingRenderer()<sp/>);</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a1956e57291066171d306c1981691f5be" kindref="member">extentChanged</ref>();</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1adbaa9fe6328d1267c71dc5887808ec65" kindref="member">rotationChanged</ref>();</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a5bbaee0bf1722dc39bd5b3c62e2ba7d9" kindref="member">destinationCrsChanged</ref>();</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a2024918fa14e5d9859b894ed33786bdf" kindref="member">outputSizeChanged</ref>();</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a534acbc9d4a6e9ef73708233f97efc92" kindref="member">outputDpiChanged</ref>();</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a551323cbaf98c6c1da70cc35721a45df" kindref="member">layersChanged</ref>();</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1ad58ca29e2bb36fb162039e33ed27e8e7" kindref="member">backgroundColorChanged</ref>();</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a62d7172a3898e29d941d2ad8e443e486" kindref="member">temporalStateChanged</ref>();</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1ad6bc6b14c95ef5dcd4174e7ccb948947" kindref="member">zRangeChanged</ref>();</highlight></codeline>
<codeline lineno="477"><highlight class="normal">}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a1f111f2e3247c552c77519c698ea3719" kindref="member">QgsQuickMapSettings::rotation</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="480"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.rotation();</highlight></codeline>
<codeline lineno="482"><highlight class="normal">}</highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a0d62b47f8092a072a830bb2be2776625" kindref="member">QgsQuickMapSettings::setRotation</ref>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rotation<sp/>)</highlight></codeline>
<codeline lineno="485"><highlight class="normal">{</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mMapSettings.rotation()<sp/>==<sp/><ref refid="classQgsQuickMapSettings_1a1f111f2e3247c552c77519c698ea3719" kindref="member">rotation</ref><sp/>)</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/>mMapSettings.setRotation(<sp/><ref refid="classQgsQuickMapSettings_1a1f111f2e3247c552c77519c698ea3719" kindref="member">rotation</ref><sp/>);</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1adbaa9fe6328d1267c71dc5887808ec65" kindref="member">rotationChanged</ref>();</highlight></codeline>
<codeline lineno="491"><highlight class="normal">}</highlight></codeline>
<codeline lineno="492"><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal">QColor<sp/><ref refid="classQgsQuickMapSettings_1a8e9229ba9bbff78bae72934b13cdf51a" kindref="member">QgsQuickMapSettings::backgroundColor</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="494"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.backgroundColor();</highlight></codeline>
<codeline lineno="496"><highlight class="normal">}</highlight></codeline>
<codeline lineno="497"><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1af947772c6a72d2a9924e5428f3b5ec78" kindref="member">QgsQuickMapSettings::setBackgroundColor</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QColor<sp/>&amp;color<sp/>)</highlight></codeline>
<codeline lineno="499"><highlight class="normal">{</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mMapSettings.backgroundColor()<sp/>==<sp/>color<sp/>)</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/>mMapSettings.setBackgroundColor(<sp/>color<sp/>);</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1ad58ca29e2bb36fb162039e33ed27e8e7" kindref="member">backgroundColorChanged</ref>();</highlight></codeline>
<codeline lineno="505"><highlight class="normal">}</highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal">qreal<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">QgsQuickMapSettings::devicePixelRatio</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="508"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mDevicePixelRatio;</highlight></codeline>
<codeline lineno="510"><highlight class="normal">}</highlight></codeline>
<codeline lineno="511"><highlight class="normal"></highlight></codeline>
<codeline lineno="512"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a9f7331fea821c67827723ec0040043fe" kindref="member">QgsQuickMapSettings::setDevicePixelRatio</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>qreal<sp/>&amp;devicePixelRatio<sp/>)</highlight></codeline>
<codeline lineno="513"><highlight class="normal">{</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/>mDevicePixelRatio<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1aa9fd36850a40a1f62de8e3a435d01344" kindref="member">devicePixelRatio</ref>;</highlight></codeline>
<codeline lineno="515"><highlight class="normal">}</highlight></codeline>
<codeline lineno="516"><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a4b103fcf5ffc8a440aee6950a7ca4d90" kindref="member">QgsQuickMapSettings::isTemporal</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="518"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.isTemporal();</highlight></codeline>
<codeline lineno="520"><highlight class="normal">}</highlight></codeline>
<codeline lineno="521"><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a0934bce893b9b17d5dee70008fcc937b" kindref="member">QgsQuickMapSettings::setIsTemporal</ref>(<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>temporal<sp/>)</highlight></codeline>
<codeline lineno="523"><highlight class="normal">{</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/>mMapSettings.setIsTemporal(<sp/>temporal<sp/>);</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a62d7172a3898e29d941d2ad8e443e486" kindref="member">temporalStateChanged</ref>();</highlight></codeline>
<codeline lineno="526"><highlight class="normal">}</highlight></codeline>
<codeline lineno="527"><highlight class="normal"></highlight></codeline>
<codeline lineno="528"><highlight class="normal">QDateTime<sp/><ref refid="classQgsQuickMapSettings_1a2b883afc5dcc3dc73978288790b4e8b5" kindref="member">QgsQuickMapSettings::temporalBegin</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="529"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.temporalRange().begin();</highlight></codeline>
<codeline lineno="531"><highlight class="normal">}</highlight></codeline>
<codeline lineno="532"><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1af2ad6b3bfa672520969085acf960c107" kindref="member">QgsQuickMapSettings::setTemporalBegin</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QDateTime<sp/>&amp;begin<sp/>)</highlight></codeline>
<codeline lineno="534"><highlight class="normal">{</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mMapSettings.temporalRange().begin()<sp/>==<sp/>begin<sp/>)</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="537"><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsDateTimeRange<sp/>range<sp/>=<sp/>mMapSettings.temporalRange();</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/>mMapSettings.setTemporalRange(<sp/>QgsDateTimeRange(<sp/>begin,<sp/>range.end()<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a62d7172a3898e29d941d2ad8e443e486" kindref="member">temporalStateChanged</ref>();</highlight></codeline>
<codeline lineno="541"><highlight class="normal">}</highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal">QDateTime<sp/><ref refid="classQgsQuickMapSettings_1abcf4b768670a784d288e2d0cac03de73" kindref="member">QgsQuickMapSettings::temporalEnd</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="544"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.temporalRange().end();</highlight></codeline>
<codeline lineno="546"><highlight class="normal">}</highlight></codeline>
<codeline lineno="547"><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ad6276a8c90c711d0ab32237a39be738e" kindref="member">QgsQuickMapSettings::setTemporalEnd</ref>(<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QDateTime<sp/>&amp;end<sp/>)</highlight></codeline>
<codeline lineno="549"><highlight class="normal">{</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mMapSettings.temporalRange().end()<sp/>==<sp/>end<sp/>)</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="552"><highlight class="normal"></highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsDateTimeRange<sp/>range<sp/>=<sp/>mMapSettings.temporalRange();</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/>mMapSettings.setTemporalRange(<sp/>QgsDateTimeRange(<sp/>range.begin(),<sp/>end<sp/>)<sp/>);</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a62d7172a3898e29d941d2ad8e443e486" kindref="member">temporalStateChanged</ref>();</highlight></codeline>
<codeline lineno="556"><highlight class="normal">}</highlight></codeline>
<codeline lineno="557"><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a2402e1c03adb13cc19314e860f4099f3" kindref="member">QgsQuickMapSettings::zRangeLower</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="559"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.zRange().lower();</highlight></codeline>
<codeline lineno="561"><highlight class="normal">}</highlight></codeline>
<codeline lineno="562"><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a42b920aec204b70c9562b62c657417ee" kindref="member">QgsQuickMapSettings::setZRangeLower</ref>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lower<sp/>)</highlight></codeline>
<codeline lineno="564"><highlight class="normal">{</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mMapSettings.zRange().lower()<sp/>==<sp/>lower<sp/>)</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="567"><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsDoubleRange<sp/>zRange(<sp/>lower,<sp/>mMapSettings.zRange().upper()<sp/>);</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/>mMapSettings.setZRange(<sp/>zRange<sp/>);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1ad6bc6b14c95ef5dcd4174e7ccb948947" kindref="member">zRangeChanged</ref>();</highlight></codeline>
<codeline lineno="571"><highlight class="normal">}</highlight></codeline>
<codeline lineno="572"><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a88d4eccce8a4aa6cbcedbbab23bec5d9" kindref="member">QgsQuickMapSettings::zRangeUpper</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="574"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mMapSettings.zRange().upper();</highlight></codeline>
<codeline lineno="576"><highlight class="normal">}</highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a90311f0d875964cdcf706dfae3c6b93c" kindref="member">QgsQuickMapSettings::setZRangeUpper</ref>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>upper<sp/>)</highlight></codeline>
<codeline lineno="579"><highlight class="normal">{</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mMapSettings.zRange().upper()<sp/>==<sp/>upper<sp/>)</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="582"><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>QgsDoubleRange<sp/>zRange(<sp/>mMapSettings.zRange().lower(),<sp/>upper<sp/>);</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/>mMapSettings.setZRange(<sp/>zRange<sp/>);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1ad6bc6b14c95ef5dcd4174e7ccb948947" kindref="member">zRangeChanged</ref>();</highlight></codeline>
<codeline lineno="586"><highlight class="normal">}</highlight></codeline>
<codeline lineno="587"><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a6a959fc142ddec4ec31981192257fbcd" kindref="member">QgsQuickMapSettings::bottomMargin</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="589"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mBottomMargin;</highlight></codeline>
<codeline lineno="591"><highlight class="normal">}</highlight></codeline>
<codeline lineno="592"><highlight class="normal"></highlight></codeline>
<codeline lineno="593"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ac331e4f449f4e840e33be609d4c8c884" kindref="member">QgsQuickMapSettings::setBottomMargin</ref>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bottomMargin<sp/>)</highlight></codeline>
<codeline lineno="594"><highlight class="normal">{</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mBottomMargin<sp/>==<sp/><ref refid="classQgsQuickMapSettings_1a6a959fc142ddec4ec31981192257fbcd" kindref="member">bottomMargin</ref><sp/>)</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="597"><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/>mBottomMargin<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1a6a959fc142ddec4ec31981192257fbcd" kindref="member">bottomMargin</ref>;</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1a588224da8e3f0627fb29d96c0a8c79d5" kindref="member">bottomMarginChanged</ref>();</highlight></codeline>
<codeline lineno="600"><highlight class="normal">}</highlight></codeline>
<codeline lineno="601"><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1ae1ba0e3f2a070ee404bd36e563cac4b1" kindref="member">QgsQuickMapSettings::rightMargin</ref>()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="603"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mRightMargin;</highlight></codeline>
<codeline lineno="605"><highlight class="normal">}</highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classQgsQuickMapSettings_1a8f9cf2c141e4cd6fb30153ab91b387e3" kindref="member">QgsQuickMapSettings::setRightMargin</ref>(<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rightMargin<sp/>)</highlight></codeline>
<codeline lineno="608"><highlight class="normal">{</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<sp/>mRightMargin<sp/>==<sp/><ref refid="classQgsQuickMapSettings_1ae1ba0e3f2a070ee404bd36e563cac4b1" kindref="member">rightMargin</ref><sp/>)</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="611"><highlight class="normal"></highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/>mRightMargin<sp/>=<sp/><ref refid="classQgsQuickMapSettings_1ae1ba0e3f2a070ee404bd36e563cac4b1" kindref="member">rightMargin</ref>;</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/>emit<sp/><ref refid="classQgsQuickMapSettings_1ad638469210ff44815256cea8d7e6b18d" kindref="member">rightMarginChanged</ref>();</highlight></codeline>
<codeline lineno="614"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="src/core/qgsquick/qgsquickmapsettings.cpp"/>
  </compounddef>
</doxygen>
